{"remainingRequest":"D:\\Desktop\\Django\\fe_admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Desktop\\Django\\fe_admin\\src\\views\\system\\permissions\\components\\cuForm.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\Desktop\\Django\\fe_admin\\src\\views\\system\\permissions\\components\\cuForm.vue","mtime":1695288475462},{"path":"D:\\Desktop\\Django\\fe_admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1698226179476},{"path":"D:\\Desktop\\Django\\fe_admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1698226183223},{"path":"D:\\Desktop\\Django\\fe_admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1698226179476},{"path":"D:\\Desktop\\Django\\fe_admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1698226183228}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBnZXRQZXJtaXNzaW9uLCB1cGRhdGVQZXJtaXNzaW9uLCBjcmVhdGVQZXJtaXNzaW9uLCBnZXRQZXJtaXNzaW9uTWV0aG9kcyB9IGZyb20gJ0AvYXBpL3N5c3RlbS9wZXJtaXNzaW9ucycNCmltcG9ydCBUcmVlc2VsZWN0IGZyb20gJ0ByaW9waGFlL3Z1ZS10cmVlc2VsZWN0Jw0KaW1wb3J0ICdAcmlvcGhhZS92dWUtdHJlZXNlbGVjdC9kaXN0L3Z1ZS10cmVlc2VsZWN0LmNzcycNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogJ0N1Rm9ybScsDQogIGNvbXBvbmVudHM6IHsgVHJlZXNlbGVjdCB9LA0KICBwcm9wczogew0KICAgIGRpYWxvZ1Zpc2libGU6IHsNCiAgICAgIHR5cGU6IEJvb2xlYW4sDQogICAgICBkZWZhdWx0OiBmYWxzZQ0KICAgIH0sDQogICAgY3VySWQ6IHsNCiAgICAgIHR5cGU6IE51bWJlciwNCiAgICAgIGRlZmF1bHQ6IG51bGwNCiAgICB9LA0KICAgIHBlcm1pc3Npb25zOiB7DQogICAgICB0eXBlOiBBcnJheSwNCiAgICAgIGRlZmF1bHQ6ICgpID0+IHsNCiAgICAgICAgcmV0dXJuDQogICAgICB9DQogICAgfQ0KICB9LA0KDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHJ1bGVGb3JtOiB7DQogICAgICAgIG5hbWU6ICcnLA0KICAgICAgICBzaWduOiAnJywNCiAgICAgICAgbWVudTogdHJ1ZSwNCiAgICAgICAgbWV0aG9kOiAnJywNCiAgICAgICAgcGF0aDogJycsDQogICAgICAgIHBpZDogbnVsbCwNCiAgICAgICAgZGVzYzogJycNCiAgICAgIH0sDQogICAgICBwZXJtaXNzaW9uTWV0aG9kczogW10sDQogICAgICBydWxlczogew0KICAgICAgICBuYW1lOiBbeyByZXF1aXJlZDogdHJ1ZSwgdHJpZ2dlcjogJ2JsdXInLCBtZXNzYWdlOiAn5p2D6ZmQ5ZCN5LiN6IO95Li656m6JyB9XSwNCiAgICAgICAgc2lnbjogW3sgcmVxdWlyZWQ6IHRydWUsIHRyaWdnZXI6ICdibHVyJywgbWVzc2FnZTogJ+adg+mZkOagh+ivhuS4jeiDveS4uuepuicgfV0sDQogICAgICAgIG1lbnU6IFt7IHJlcXVpcmVkOiB0cnVlLCB0cmlnZ2VyOiAnYmx1cicsIG1lc3NhZ2U6ICfmmK/lkKbkuLroj5zljZXkuI3og73kuLrnqbonIH1dLA0KICAgICAgICBtZXRob2Q6IFt7IHJlcXVpcmVkOiB0cnVlLCB0cmlnZ2VyOiAnYmx1cicsIG1lc3NhZ2U6ICfor7fmsYLmlrnms5XkuI3og73kuLrnqbonIH1dLA0KICAgICAgICBwYXRoOiBbeyByZXF1aXJlZDogdHJ1ZSwgdHJpZ2dlcjogJ2JsdXInLCBtZXNzYWdlOiAn6K+35rGC6Lev5b6E5LiN6IO95Li656m6JyB9XQ0KICAgICAgfQ0KICAgIH0NCiAgfSwNCiAgd2F0Y2g6IHsNCiAgICBkaWFsb2dWaXNpYmxlKHYpIHsNCiAgICAgIGlmICh2KSB7DQogICAgICAgIGlmICh0aGlzLmN1cklkKSB7DQogICAgICAgICAgZ2V0UGVybWlzc2lvbih0aGlzLmN1cklkKS50aGVuKHJlcyA9PiB7DQogICAgICAgICAgICB0aGlzLnJ1bGVGb3JtID0gcmVzLmRhdGENCiAgICAgICAgICB9KQ0KICAgICAgICB9DQogICAgICAgIC8vIOiOt+WPluivt+axguaWueazlQ0KICAgICAgICB0aGlzLmdldE1ldGhvZCgpDQogICAgICB9DQogICAgfQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgY2xvc2UoKSB7DQogICAgICB0aGlzLiRyZWZzLnJ1bGVGb3JtLnJlc2V0RmllbGRzKCkNCiAgICAgIHRoaXMucnVsZUZvcm0ubWV0aG9kID0gJycNCiAgICAgIHRoaXMucnVsZUZvcm0ucGF0aCA9ICcnDQogICAgICB0aGlzLiRlbWl0KCdjbG9zZScpDQogICAgfSwNCiAgICBzZWFyY2goKSB7DQogICAgICB0aGlzLmNsb3NlKCkNCiAgICAgIHRoaXMuJGVtaXQoJ3NlYXJjaCcpDQogICAgfSwNCiAgICBnZXRNZXRob2QoKSB7DQogICAgICBnZXRQZXJtaXNzaW9uTWV0aG9kcygpLnRoZW4ocmVzID0+IHsNCiAgICAgICAgdGhpcy5wZXJtaXNzaW9uTWV0aG9kcyA9IHJlcy5kYXRhLnJlc3VsdHMNCiAgICAgIH0pDQogICAgfSwNCiAgICAvLyDmj5DkuqTooajljZUNCiAgICBzdWJtaXRGb3JtKGZvcm1OYW1lKSB7DQogICAgICB0aGlzLiRyZWZzW2Zvcm1OYW1lXS52YWxpZGF0ZSgodmFsaWQpID0+IHsNCiAgICAgICAgaWYgKHZhbGlkKSB7DQogICAgICAgICAgaWYgKHRoaXMuY3VySWQpIHsNCiAgICAgICAgICAgIGlmICghdGhpcy5ydWxlRm9ybS5waWQpIHsNCiAgICAgICAgICAgICAgdGhpcy5ydWxlRm9ybS5waWQgPSBudWxsDQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAodGhpcy5ydWxlRm9ybS5tZW51ID09PSB0cnVlKSB7DQogICAgICAgICAgICAgIHRoaXMucnVsZUZvcm0ubWV0aG9kID0gJycNCiAgICAgICAgICAgICAgdGhpcy5ydWxlRm9ybS5wYXRoID0gJycNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHVwZGF0ZVBlcm1pc3Npb24odGhpcy5jdXJJZCwgdGhpcy5ydWxlRm9ybSkudGhlbihyZXMgPT4gew0KICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgICAgICBtZXNzYWdlOiAn5L+u5pS55oiQ5YqfJywNCiAgICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycNCiAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgdGhpcy5zZWFyY2goKQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgY3JlYXRlUGVybWlzc2lvbih0aGlzLnJ1bGVGb3JtKS50aGVuKHJlcyA9PiB7DQogICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICfmlrDlop7miJDlip8nLA0KICAgICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJw0KICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICB0aGlzLnNlYXJjaCgpDQogICAgICAgICAgICB9KQ0KICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICBjb25zb2xlLmxvZygnZXJyb3Igc3VibWl0ISEnKQ0KICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgICB9DQogICAgICB9KQ0KICAgIH0sDQogICAgcmVzZXRGb3JtKGZvcm1OYW1lKSB7DQogICAgICB0aGlzLiRyZWZzW2Zvcm1OYW1lXS5yZXNldEZpZWxkcygpDQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["cuForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"cuForm.vue","sourceRoot":"src/views/system/permissions/components","sourcesContent":["<template>\r\n  <el-dialog :close-on-click-modal=\"false\" :visible.sync=\"dialogVisible\" :title=\"curId ? '编辑权限' : '新增权限'\" width=\"700px\" :before-close=\"close\">\r\n    <el-form ref=\"ruleForm\" label-position=\"left  \" :model=\"ruleForm\" status-icon :rules=\"rules\" label-width=\"100px\" class=\"demo-ruleForm\">\r\n      <el-form-item label=\"权限名\" prop=\"name\">\r\n        <el-input v-model=\"ruleForm.name\" clearable />\r\n      </el-form-item>\r\n      <el-form-item label=\"权限标识\" prop=\"sign\">\r\n        <el-input v-model=\"ruleForm.sign\" clearable />\r\n      </el-form-item>\r\n      <el-form-item label=\"是否为菜单\" prop=\"menu\">\r\n        <el-switch\r\n          v-model=\"ruleForm.menu\"\r\n          active-text=\"是\"\r\n          inactive-text=\"否\"\r\n        />\r\n      </el-form-item>\r\n      <template v-if=\"ruleForm.menu===false\">\r\n        <el-form-item label=\"请求方法\" prop=\"method\">\r\n          <el-select v-model=\"ruleForm.method\" clearable placeholder=\"选择请求方法\">\r\n            <el-option\r\n              v-for=\"item in permissionMethods\"\r\n              :key=\"item.value\"\r\n              :label=\"item.value\"\r\n              :value=\"item.value\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"请求路径\" prop=\"path\">\r\n          <el-input v-model=\"ruleForm.path\" clearable />\r\n        </el-form-item>\r\n      </template>\r\n      <el-form-item label=\"父权限\" prop=\"pid\">\r\n        <treeselect\r\n          v-model=\"ruleForm.pid\"\r\n          :options=\"permissions\"\r\n          style=\"width: 178px\"\r\n          placeholder=\"选择父权限\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item label=\"描述\" prop=\"desc\">\r\n        <el-input v-model=\"ruleForm.desc\" clearable />\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"submitForm('ruleForm')\">提交</el-button>\r\n        <el-button @click=\"resetForm('ruleForm')\">重置</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </el-dialog>\r\n</template>\r\n<script>\r\nimport { getPermission, updatePermission, createPermission, getPermissionMethods } from '@/api/system/permissions'\r\nimport Treeselect from '@riophae/vue-treeselect'\r\nimport '@riophae/vue-treeselect/dist/vue-treeselect.css'\r\nexport default {\r\n  name: 'CuForm',\r\n  components: { Treeselect },\r\n  props: {\r\n    dialogVisible: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    curId: {\r\n      type: Number,\r\n      default: null\r\n    },\r\n    permissions: {\r\n      type: Array,\r\n      default: () => {\r\n        return\r\n      }\r\n    }\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      ruleForm: {\r\n        name: '',\r\n        sign: '',\r\n        menu: true,\r\n        method: '',\r\n        path: '',\r\n        pid: null,\r\n        desc: ''\r\n      },\r\n      permissionMethods: [],\r\n      rules: {\r\n        name: [{ required: true, trigger: 'blur', message: '权限名不能为空' }],\r\n        sign: [{ required: true, trigger: 'blur', message: '权限标识不能为空' }],\r\n        menu: [{ required: true, trigger: 'blur', message: '是否为菜单不能为空' }],\r\n        method: [{ required: true, trigger: 'blur', message: '请求方法不能为空' }],\r\n        path: [{ required: true, trigger: 'blur', message: '请求路径不能为空' }]\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    dialogVisible(v) {\r\n      if (v) {\r\n        if (this.curId) {\r\n          getPermission(this.curId).then(res => {\r\n            this.ruleForm = res.data\r\n          })\r\n        }\r\n        // 获取请求方法\r\n        this.getMethod()\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    close() {\r\n      this.$refs.ruleForm.resetFields()\r\n      this.ruleForm.method = ''\r\n      this.ruleForm.path = ''\r\n      this.$emit('close')\r\n    },\r\n    search() {\r\n      this.close()\r\n      this.$emit('search')\r\n    },\r\n    getMethod() {\r\n      getPermissionMethods().then(res => {\r\n        this.permissionMethods = res.data.results\r\n      })\r\n    },\r\n    // 提交表单\r\n    submitForm(formName) {\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          if (this.curId) {\r\n            if (!this.ruleForm.pid) {\r\n              this.ruleForm.pid = null\r\n            }\r\n            if (this.ruleForm.menu === true) {\r\n              this.ruleForm.method = ''\r\n              this.ruleForm.path = ''\r\n            }\r\n            updatePermission(this.curId, this.ruleForm).then(res => {\r\n              this.$message({\r\n                message: '修改成功',\r\n                type: 'success'\r\n              })\r\n              this.search()\r\n            })\r\n          } else {\r\n            createPermission(this.ruleForm).then(res => {\r\n              this.$message({\r\n                message: '新增成功',\r\n                type: 'success'\r\n              })\r\n              this.search()\r\n            })\r\n          }\r\n        } else {\r\n          console.log('error submit!!')\r\n          return false\r\n        }\r\n      })\r\n    },\r\n    resetForm(formName) {\r\n      this.$refs[formName].resetFields()\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}