{"remainingRequest":"D:\\Desktop\\Django\\fe_admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Desktop\\Django\\fe_admin\\src\\views\\system\\permissions\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\Desktop\\Django\\fe_admin\\src\\views\\system\\permissions\\index.vue","mtime":1697857778095},{"path":"D:\\Desktop\\Django\\fe_admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1698226179476},{"path":"D:\\Desktop\\Django\\fe_admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1698226183223},{"path":"D:\\Desktop\\Django\\fe_admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1698226179476},{"path":"D:\\Desktop\\Django\\fe_admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1698226183228}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgY3VGb3JtIGZyb20gJy4vY29tcG9uZW50cy9jdUZvcm0nDQppbXBvcnQgeyBnZXRQZXJtaXNzaW9ucywgZGVsZXRlUGVybWlzc2lvbiwgZGVsZXRlUGVybWlzc2lvbnMgfSBmcm9tICdAL2FwaS9zeXN0ZW0vcGVybWlzc2lvbnMnDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdQZXJtaXNzaW9ucycsDQogIGNvbXBvbmVudHM6IHsgY3VGb3JtIH0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGZvcm06IHsNCiAgICAgICAgc2VhcmNoOiAnJywNCiAgICAgICAgb3JkZXJpbmc6ICdpZCcNCiAgICAgIH0sDQogICAgICB0YWJsZURhdGE6IFtdLA0KICAgICAgaXNBbGxTZWxlY3Q6IGZhbHNlLA0KICAgICAgbXVsdGlwbGVTZWxlY3Rpb246IFtdLA0KICAgICAgLy8gY3VGb3Jt5pWw5o2uDQogICAgICBjdURpYWxvZ1Zpc2libGU6IGZhbHNlLA0KICAgICAgY3VySWQ6IG51bGwNCiAgICB9DQogIH0sDQogIGNyZWF0ZWQoKSB7DQogICAgdGhpcy5zZWFyY2goKQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgLy8g6I635Y+W5p2D6ZmQVHJlZeWIl+ihqC/mkJzntKLlip/og70NCiAgICBzZWFyY2goKSB7DQogICAgICBnZXRQZXJtaXNzaW9ucyh0aGlzLmZvcm0pLnRoZW4ocmVzID0+IHsNCiAgICAgICAgY29uc29sZS5sb2cocmVzKQ0KICAgICAgICB0aGlzLnRhYmxlRGF0YSA9IHJlcy5kYXRhDQogICAgICB9KQ0KICAgIH0sDQogICAgLy8g6YeN572uDQogICAgcmVzZXRGb3JtKCkgew0KICAgICAgdGhpcy4kcmVmcy5mb3JtLnJlc2V0RmllbGRzKCkNCiAgICAgIHRoaXMuc2VhcmNoKCkNCiAgICB9LA0KICAgIC8vIOWIoOmZpOadg+mZkA0KICAgIGRlbGV0ZVBlcm1pc3Npb24ocm93KSB7DQogICAgICB0aGlzLiRjb25maXJtKCfmraTmk43kvZzlsIbliKDpmaTmnYPpmZAgIicgKyByb3cubmFtZSArICciIOWPiuWFtuWtkOadg+mZkCcgKyAnICwg5piv5ZCm57un57ut77yfJywgJ+aPkOekuicsIHsNCiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLA0KICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywNCiAgICAgICAgdHlwZTogJ3dhcm5pbmcnDQogICAgICB9KS50aGVuKCgpID0+IHsNCiAgICAgICAgZGVsZXRlUGVybWlzc2lvbihyb3cuaWQpLnRoZW4ocmVzID0+IHsNCiAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgIG1lc3NhZ2U6ICfliKDpmaTmnYPpmZAnICsgcm93Lm5hbWUgKyAn5oiQ5YqfJywNCiAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJw0KICAgICAgICAgIH0pDQogICAgICAgICAgLy8g5Yi35pawdGFibGUNCiAgICAgICAgICB0aGlzLnNlYXJjaCgpDQogICAgICAgIH0pDQogICAgICB9KQ0KICAgIH0sDQogICAgLy8g5om56YeP5Yig6Zmk5p2D6ZmQDQogICAgZGVsZXRlUGVybWlzc2lvbnMoKSB7DQogICAgICB0aGlzLiRjb25maXJtKCfmraTmk43kvZzlsIbliKDpmaTpgInkuK3mnYPpmZDlj4rlhbblrZDmnYPpmZAnICsgJywg5piv5ZCm57un57ut77yfJywgJ+aPkOekuicsIHsNCiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLA0KICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywNCiAgICAgICAgdHlwZTogJ3dhcm5pbmcnDQogICAgICB9KS50aGVuKCgpID0+IHsNCiAgICAgICAgZGVsZXRlUGVybWlzc2lvbnModGhpcy5tdWx0aXBsZVNlbGVjdGlvbikudGhlbihyZXMgPT4gew0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgICAgbWVzc2FnZTogJ+WIoOmZpOadg+mZkOaIkOWKnycsDQogICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycNCiAgICAgICAgICB9KQ0KICAgICAgICAgIC8vIOWIt+aWsHRhYmxlDQogICAgICAgICAgdGhpcy5zZWFyY2goKQ0KICAgICAgICB9KQ0KICAgICAgfSkNCiAgICB9LA0KICAgIC8vIHRhYmxl5YWo6YCJ5LqL5Lu2DQogICAgc2VsZWN0QWxsQ2hhbmdlKHNlbGVjdGlvbikgew0KICAgICAgLy8g5aaC5p6c6YCJ5Lit55qE5pWw55uu5LiO6K+35rGC5Yiw55qE5pWw55uu55u45ZCM5bCx6YCJ5Lit5omA5pyJ5a2Q6IqC54K577yM5ZCm5YiZ5bCx5riF56m6DQogICAgICBjb25zb2xlLmxvZyhzZWxlY3Rpb24pDQogICAgICBpZiAoc2VsZWN0aW9uICYmIHNlbGVjdGlvbi5sZW5ndGggPT09IHRoaXMudGFibGVEYXRhLmxlbmd0aCAmJiBzZWxlY3Rpb25bMF0uaWQgPT09IHRoaXMudGFibGVEYXRhWzBdLmlkKSB7DQogICAgICAgIHNlbGVjdGlvbi5mb3JFYWNoKHZhbCA9PiB7DQogICAgICAgICAgdGhpcy5zZWxlY3RDaGFuZ2Uoc2VsZWN0aW9uLCB2YWwpDQogICAgICAgIH0pDQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLiRyZWZzLnRhYmxlLmNsZWFyU2VsZWN0aW9uKCkNCiAgICAgIH0NCiAgICB9LA0KICAgIC8vIOmAiemhueahhueCueWHu+S6i+S7tg0KICAgIHNlbGVjdENoYW5nZShzZWxlY3Rpb24sIHJvdykgew0KICAgICAgLy8g5aaC5p6cc2VsZWN0aW9u5Lit5a2Y5Zyocm935Luj6KGo5piv6YCJ5Lit77yM5ZCm5YiZ5piv5Y+W5raI6YCJ5LitDQogICAgICBpZiAoc2VsZWN0aW9uLmluZGV4T2Yocm93KSAhPT0gLTEpIHsNCiAgICAgICAgaWYgKHJvdy5jaGlsZHJlbikgew0KICAgICAgICAgIHJvdy5jaGlsZHJlbi5mb3JFYWNoKHZhbCA9PiB7DQogICAgICAgICAgICBzZWxlY3Rpb24ucHVzaCh2YWwpDQogICAgICAgICAgICB0aGlzLiRyZWZzLnRhYmxlLnRvZ2dsZVJvd1NlbGVjdGlvbih2YWwsIHRydWUpDQogICAgICAgICAgICB0aGlzLnNlbGVjdENoYW5nZShzZWxlY3Rpb24sIHZhbCkNCiAgICAgICAgICB9KQ0KICAgICAgICB9DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLnJldmVyc2VSb3dTZWxlY3Rpb24oc2VsZWN0aW9uLCByb3cpDQogICAgICB9DQogICAgfSwNCiAgICAvLyDlj5bmtojpgInmi6kNCiAgICByZXZlcnNlUm93U2VsZWN0aW9uKHNlbGVjdGlvbiwgZGF0YSkgew0KICAgICAgaWYgKGRhdGEuY2hpbGRyZW4pIHsNCiAgICAgICAgZGF0YS5jaGlsZHJlbi5mb3JFYWNoKHZhbCA9PiB7DQogICAgICAgICAgdGhpcy4kcmVmcy50YWJsZS50b2dnbGVSb3dTZWxlY3Rpb24odmFsLCBmYWxzZSkNCiAgICAgICAgICBpZiAodmFsLmNoaWxkcmVuKSB7DQogICAgICAgICAgICB0aGlzLnJldmVyc2VSb3dTZWxlY3Rpb24oc2VsZWN0aW9uLCB2YWwpDQogICAgICAgICAgfQ0KICAgICAgICB9KQ0KICAgICAgfQ0KICAgIH0sDQogICAgLy8g6YCJ6aG55pS55Y+Y5pe26Kem5Y+RDQogICAgaGFuZGxlU2VsZWN0aW9uQ2hhbmdlKHZhbCkgew0KICAgICAgY29uc3QgZGVsZXRlSWRzID0gW10NCiAgICAgIHRoaXMuJHJlZnMudGFibGUuc2VsZWN0aW9uLmZvckVhY2goZGF0YSA9PiBkZWxldGVJZHMucHVzaChkYXRhLmlkKSkNCiAgICAgIHRoaXMubXVsdGlwbGVTZWxlY3Rpb24gPSBkZWxldGVJZHMNCiAgICB9LA0KICAgIC8vIGN1Rm9ybeWtkOe7hOS7tg0KICAgIGNyZWF0ZVBlcm1pc3Npb24oKSB7DQogICAgICB0aGlzLmN1RGlhbG9nVmlzaWJsZSA9IHRydWUNCiAgICB9LA0KICAgIHVwZGF0ZVBlcm1pc3Npb24ocm93KSB7DQogICAgICB0aGlzLmN1cklkID0gcm93LmlkDQogICAgICB0aGlzLmN1RGlhbG9nVmlzaWJsZSA9IHRydWUNCiAgICB9LA0KICAgIGNsb3NlKCkgew0KICAgICAgdGhpcy5jdURpYWxvZ1Zpc2libGUgPSBmYWxzZQ0KICAgICAgdGhpcy5jdXJJZCA9IG51bGwNCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/system/permissions","sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <el-form ref=\"form\" :model=\"form\" inline>\r\n      <el-form-item prop=\"search\">\r\n        <el-input v-model=\"form.search\" clearable style=\"width:300px\" prefix-icon=\"el-icon-search\" placeholder=\"输入权限名、描述、路径搜索\" />\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"success\" icon=\"el-icon-search\" size=\"medium\" @click=\"search(form)\">搜索</el-button>\r\n        <el-button type=\"warning\" icon=\"el-icon-refresh-left\" size=\"medium\" @click=\"resetForm()\">重置</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n    <el-button v-permission=\"['admin','system-permissions-add']\" type=\"primary\" style=\"margin-bottom:20px\" icon=\"el-icon-plus\" size=\"medium\" @click=\"createPermission()\">新增</el-button>\r\n    <el-button v-permission=\"['admin','system-permissions-mdel']\" type=\"danger\" icon=\"el-icon-delete\" :disabled=\"multipleSelection.length ? false : true\" size=\"medium\" @click=\"deletePermissions(form)\">删除</el-button>\r\n    <el-table\r\n      ref=\"table\"\r\n      :data=\"tableData\"\r\n      style=\"width: 100%;margin-bottom: 20px;\"\r\n      row-key=\"id\"\r\n      :tree-props=\"{children: 'children', hasChildren: 'hasChildren'}\"\r\n      @select-all=\"selectAllChange\"\r\n      @selection-change=\"handleSelectionChange\"\r\n      @select=\"selectChange\"\r\n    >\r\n      <el-table-column\r\n        type=\"selection\"\r\n        width=\"55\"\r\n      />\r\n      <el-table-column\r\n        prop=\"name\"\r\n        label=\"权限名\"\r\n        width=\"180\"\r\n        show-overflow-tooltip\r\n      />\r\n      <el-table-column\r\n        prop=\"sign\"\r\n        label=\"权限标识\"\r\n        width=\"180\"\r\n        show-overflow-tooltip\r\n      />\r\n      <el-table-column\r\n        prop=\"menu\"\r\n        label=\"是否为菜单\"\r\n        width=\"120\"\r\n      >\r\n        <template slot-scope=\"{row}\">\r\n          <el-tag v-if=\"row.menu\">是</el-tag>\r\n          <el-tag v-else type=\"warning\">否</el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column\r\n        prop=\"path\"\r\n        label=\"请求路径\"\r\n      />\r\n      <el-table-column\r\n        prop=\"method\"\r\n        label=\"请求方法\"\r\n        width=\"100\"\r\n      />\r\n      <el-table-column\r\n        prop=\"desc\"\r\n        label=\"描述\"\r\n        width=\"100\"\r\n        show-overflow-tooltip\r\n      />\r\n      <el-table-column\r\n        fixed=\"right\"\r\n        align=\"center\"\r\n        label=\"操作\"\r\n        width=\"220\"\r\n      >\r\n        <template slot-scope=\"{row}\">\r\n          <el-button v-permission=\"['admin','system-permissions-update']\" type=\"primary\" icon=\"el-icon-edit\" size=\"mini\" @click=\"updatePermission(row)\">编辑</el-button>\r\n          <el-button v-permission=\"['admin','system-permissions-del']\" type=\"danger\" icon=\"el-icon-delete\" size=\"mini\" @click=\"deletePermission(row)\">删除</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <cuForm :dialog-visible=\"cuDialogVisible\" :cur-id=\"curId\" :permissions=\"tableData\" @close=\"close\" @search=\"search\" />\r\n  </div>\r\n</template>\r\n<script>\r\nimport cuForm from './components/cuForm'\r\nimport { getPermissions, deletePermission, deletePermissions } from '@/api/system/permissions'\r\nexport default {\r\n  name: 'Permissions',\r\n  components: { cuForm },\r\n  data() {\r\n    return {\r\n      form: {\r\n        search: '',\r\n        ordering: 'id'\r\n      },\r\n      tableData: [],\r\n      isAllSelect: false,\r\n      multipleSelection: [],\r\n      // cuForm数据\r\n      cuDialogVisible: false,\r\n      curId: null\r\n    }\r\n  },\r\n  created() {\r\n    this.search()\r\n  },\r\n  methods: {\r\n    // 获取权限Tree列表/搜索功能\r\n    search() {\r\n      getPermissions(this.form).then(res => {\r\n        console.log(res)\r\n        this.tableData = res.data\r\n      })\r\n    },\r\n    // 重置\r\n    resetForm() {\r\n      this.$refs.form.resetFields()\r\n      this.search()\r\n    },\r\n    // 删除权限\r\n    deletePermission(row) {\r\n      this.$confirm('此操作将删除权限 \"' + row.name + '\" 及其子权限' + ' , 是否继续？', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(() => {\r\n        deletePermission(row.id).then(res => {\r\n          this.$message({\r\n            message: '删除权限' + row.name + '成功',\r\n            type: 'success'\r\n          })\r\n          // 刷新table\r\n          this.search()\r\n        })\r\n      })\r\n    },\r\n    // 批量删除权限\r\n    deletePermissions() {\r\n      this.$confirm('此操作将删除选中权限及其子权限' + ', 是否继续？', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(() => {\r\n        deletePermissions(this.multipleSelection).then(res => {\r\n          this.$message({\r\n            message: '删除权限成功',\r\n            type: 'success'\r\n          })\r\n          // 刷新table\r\n          this.search()\r\n        })\r\n      })\r\n    },\r\n    // table全选事件\r\n    selectAllChange(selection) {\r\n      // 如果选中的数目与请求到的数目相同就选中所有子节点，否则就清空\r\n      console.log(selection)\r\n      if (selection && selection.length === this.tableData.length && selection[0].id === this.tableData[0].id) {\r\n        selection.forEach(val => {\r\n          this.selectChange(selection, val)\r\n        })\r\n      } else {\r\n        this.$refs.table.clearSelection()\r\n      }\r\n    },\r\n    // 选项框点击事件\r\n    selectChange(selection, row) {\r\n      // 如果selection中存在row代表是选中，否则是取消选中\r\n      if (selection.indexOf(row) !== -1) {\r\n        if (row.children) {\r\n          row.children.forEach(val => {\r\n            selection.push(val)\r\n            this.$refs.table.toggleRowSelection(val, true)\r\n            this.selectChange(selection, val)\r\n          })\r\n        }\r\n      } else {\r\n        this.reverseRowSelection(selection, row)\r\n      }\r\n    },\r\n    // 取消选择\r\n    reverseRowSelection(selection, data) {\r\n      if (data.children) {\r\n        data.children.forEach(val => {\r\n          this.$refs.table.toggleRowSelection(val, false)\r\n          if (val.children) {\r\n            this.reverseRowSelection(selection, val)\r\n          }\r\n        })\r\n      }\r\n    },\r\n    // 选项改变时触发\r\n    handleSelectionChange(val) {\r\n      const deleteIds = []\r\n      this.$refs.table.selection.forEach(data => deleteIds.push(data.id))\r\n      this.multipleSelection = deleteIds\r\n    },\r\n    // cuForm子组件\r\n    createPermission() {\r\n      this.cuDialogVisible = true\r\n    },\r\n    updatePermission(row) {\r\n      this.curId = row.id\r\n      this.cuDialogVisible = true\r\n    },\r\n    close() {\r\n      this.cuDialogVisible = false\r\n      this.curId = null\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}