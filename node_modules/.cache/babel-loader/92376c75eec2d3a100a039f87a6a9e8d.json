{"remainingRequest":"D:\\Desktop\\Django\\fe_admin\\node_modules\\babel-loader\\lib\\index.js!D:\\Desktop\\Django\\fe_admin\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\Desktop\\Django\\fe_admin\\src\\store\\modules\\permission.js","dependencies":[{"path":"D:\\Desktop\\Django\\fe_admin\\src\\store\\modules\\permission.js","mtime":1695288475447},{"path":"D:\\Desktop\\Django\\fe_admin\\babel.config.js","mtime":1695288475407},{"path":"D:\\Desktop\\Django\\fe_admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1698226179476},{"path":"D:\\Desktop\\Django\\fe_admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1698226183223},{"path":"D:\\Desktop\\Django\\fe_admin\\node_modules\\eslint-loader\\index.js","mtime":1698226179382}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiRDovRGVza3RvcC9EamFuZ28vZmVfYWRtaW4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0IHsgYXN5bmNSb3V0ZXMsIGNvbnN0YW50Um91dGVzIH0gZnJvbSAnQC9yb3V0ZXInOwppbXBvcnQgc3RvcmUgZnJvbSAnLi4vaW5kZXgnOwoKLyoqDQogKiBVc2UgbWV0YS5wZXJtaXNzaW9uIHRvIGRldGVybWluZSBpZiB0aGUgY3VycmVudCB1c2VyIGhhcyBwZXJtaXNzaW9uDQogKiBAcGFyYW0gcGVybWlzc2lvbnMNCiAqIEBwYXJhbSByb3V0ZQ0KICovCmZ1bmN0aW9uIGhhc1Blcm1pc3Npb24ocGVybWlzc2lvbnMsIHJvdXRlKSB7CiAgaWYgKHJvdXRlLm1ldGEgJiYgcm91dGUubWV0YS5wZXJtaXNzaW9ucykgewogICAgcmV0dXJuIHBlcm1pc3Npb25zLnNvbWUoZnVuY3Rpb24gKHBlcm1pc3Npb24pIHsKICAgICAgcmV0dXJuIHJvdXRlLm1ldGEucGVybWlzc2lvbnMuaW5jbHVkZXMocGVybWlzc2lvbik7CiAgICB9KTsKICB9IGVsc2UgewogICAgcmV0dXJuIHRydWU7CiAgfQp9CgovKioNCiAqIOmAmui/h+mAkuW9kui/h+a7pOW8guatpei3r+eUseihqA0KICogQHBhcmFtIHJvdXRlcyBhc3luY1JvdXRlcyjmnInmnYPpmZDmjqfliLbnmoTot6/nlLEpDQogKiBAcGFyYW0gcGVybWlzc2lvbnMNCiAqLwpleHBvcnQgZnVuY3Rpb24gZmlsdGVyQXN5bmNSb3V0ZXMocm91dGVzLCBwZXJtaXNzaW9ucykgewogIHZhciByZXMgPSBbXTsKICByb3V0ZXMuZm9yRWFjaChmdW5jdGlvbiAocm91dGUpIHsKICAgIHZhciB0bXAgPSBfb2JqZWN0U3ByZWFkKHt9LCByb3V0ZSk7CiAgICBpZiAoaGFzUGVybWlzc2lvbihwZXJtaXNzaW9ucywgdG1wKSkgewogICAgICBpZiAodG1wLmNoaWxkcmVuKSB7CiAgICAgICAgdG1wLmNoaWxkcmVuID0gZmlsdGVyQXN5bmNSb3V0ZXModG1wLmNoaWxkcmVuLCBwZXJtaXNzaW9ucyk7CiAgICAgIH0KICAgICAgcmVzLnB1c2godG1wKTsKICAgIH0KICB9KTsKICByZXR1cm4gcmVzOwp9CnZhciBzdGF0ZSA9IHsKICByb3V0ZXM6IFtdLAogIGFkZFJvdXRlczogW10KfTsKdmFyIG11dGF0aW9ucyA9IHsKICBTRVRfUk9VVEVTOiBmdW5jdGlvbiBTRVRfUk9VVEVTKHN0YXRlLCByb3V0ZXMpIHsKICAgIHN0YXRlLmFkZFJvdXRlcyA9IHJvdXRlczsKICAgIHN0YXRlLnJvdXRlcyA9IGNvbnN0YW50Um91dGVzLmNvbmNhdChyb3V0ZXMpOwogIH0KfTsKdmFyIGFjdGlvbnMgPSB7CiAgZ2VuZXJhdGVSb3V0ZXM6IGZ1bmN0aW9uIGdlbmVyYXRlUm91dGVzKF9yZWYpIHsKICAgIHZhciBjb21taXQgPSBfcmVmLmNvbW1pdDsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICBzdG9yZS5kaXNwYXRjaCgndXNlci9nZXRJbmZvJykudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgdmFyIGFjY2Vzc2VkUm91dGVzID0gZmlsdGVyQXN5bmNSb3V0ZXMoYXN5bmNSb3V0ZXMsIHJlcy5wZXJtaXNzaW9ucyk7CiAgICAgICAgY29tbWl0KCdTRVRfUk9VVEVTJywgYWNjZXNzZWRSb3V0ZXMpOwogICAgICAgIHJlc29sdmUoYWNjZXNzZWRSb3V0ZXMpOwogICAgICB9KTsKICAgIH0pOwogIH0KfTsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWVzcGFjZWQ6IHRydWUsCiAgc3RhdGU6IHN0YXRlLAogIG11dGF0aW9uczogbXV0YXRpb25zLAogIGFjdGlvbnM6IGFjdGlvbnMKfTs="},{"version":3,"names":["asyncRoutes","constantRoutes","store","hasPermission","permissions","route","meta","some","permission","includes","filterAsyncRoutes","routes","res","forEach","tmp","_objectSpread","children","push","state","addRoutes","mutations","SET_ROUTES","concat","actions","generateRoutes","_ref","commit","Promise","resolve","dispatch","then","accessedRoutes","namespaced"],"sources":["D:/Desktop/Django/fe_admin/src/store/modules/permission.js"],"sourcesContent":["import { asyncRoutes, constantRoutes } from '@/router'\r\nimport store from '../index'\r\n\r\n/**\r\n * Use meta.permission to determine if the current user has permission\r\n * @param permissions\r\n * @param route\r\n */\r\nfunction hasPermission(permissions, route) {\r\n  if (route.meta && route.meta.permissions) {\r\n    return permissions.some(permission => route.meta.permissions.includes(permission))\r\n  } else {\r\n    return true\r\n  }\r\n}\r\n\r\n/**\r\n * 通过递归过滤异步路由表\r\n * @param routes asyncRoutes(有权限控制的路由)\r\n * @param permissions\r\n */\r\nexport function filterAsyncRoutes(routes, permissions) {\r\n  const res = []\r\n\r\n  routes.forEach(route => {\r\n    const tmp = { ...route }\r\n    if (hasPermission(permissions, tmp)) {\r\n      if (tmp.children) {\r\n        tmp.children = filterAsyncRoutes(tmp.children, permissions)\r\n      }\r\n      res.push(tmp)\r\n    }\r\n  })\r\n\r\n  return res\r\n}\r\n\r\nconst state = {\r\n  routes: [],\r\n  addRoutes: []\r\n}\r\n\r\nconst mutations = {\r\n  SET_ROUTES: (state, routes) => {\r\n    state.addRoutes = routes\r\n    state.routes = constantRoutes.concat(routes)\r\n  }\r\n}\r\n\r\nconst actions = {\r\n  generateRoutes({ commit }) {\r\n    return new Promise(resolve => {\r\n      store.dispatch('user/getInfo').then(res => {\r\n        const accessedRoutes = filterAsyncRoutes(asyncRoutes, res.permissions)\r\n        commit('SET_ROUTES', accessedRoutes)\r\n        resolve(accessedRoutes)\r\n      })\r\n    })\r\n  }\r\n}\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  mutations,\r\n  actions\r\n}\r\n"],"mappings":";;;;;;AAAA,SAASA,WAAW,EAAEC,cAAc,QAAQ,UAAU;AACtD,OAAOC,KAAK,MAAM,UAAU;;AAE5B;AACA;AACA;AACA;AACA;AACA,SAASC,aAAaA,CAACC,WAAW,EAAEC,KAAK,EAAE;EACzC,IAAIA,KAAK,CAACC,IAAI,IAAID,KAAK,CAACC,IAAI,CAACF,WAAW,EAAE;IACxC,OAAOA,WAAW,CAACG,IAAI,CAAC,UAAAC,UAAU;MAAA,OAAIH,KAAK,CAACC,IAAI,CAACF,WAAW,CAACK,QAAQ,CAACD,UAAU,CAAC;IAAA,EAAC;EACpF,CAAC,MAAM;IACL,OAAO,IAAI;EACb;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASE,iBAAiBA,CAACC,MAAM,EAAEP,WAAW,EAAE;EACrD,IAAMQ,GAAG,GAAG,EAAE;EAEdD,MAAM,CAACE,OAAO,CAAC,UAAAR,KAAK,EAAI;IACtB,IAAMS,GAAG,GAAAC,aAAA,KAAQV,KAAK,CAAE;IACxB,IAAIF,aAAa,CAACC,WAAW,EAAEU,GAAG,CAAC,EAAE;MACnC,IAAIA,GAAG,CAACE,QAAQ,EAAE;QAChBF,GAAG,CAACE,QAAQ,GAAGN,iBAAiB,CAACI,GAAG,CAACE,QAAQ,EAAEZ,WAAW,CAAC;MAC7D;MACAQ,GAAG,CAACK,IAAI,CAACH,GAAG,CAAC;IACf;EACF,CAAC,CAAC;EAEF,OAAOF,GAAG;AACZ;AAEA,IAAMM,KAAK,GAAG;EACZP,MAAM,EAAE,EAAE;EACVQ,SAAS,EAAE;AACb,CAAC;AAED,IAAMC,SAAS,GAAG;EAChBC,UAAU,EAAE,SAAAA,WAACH,KAAK,EAAEP,MAAM,EAAK;IAC7BO,KAAK,CAACC,SAAS,GAAGR,MAAM;IACxBO,KAAK,CAACP,MAAM,GAAGV,cAAc,CAACqB,MAAM,CAACX,MAAM,CAAC;EAC9C;AACF,CAAC;AAED,IAAMY,OAAO,GAAG;EACdC,cAAc,WAAAA,eAAAC,IAAA,EAAa;IAAA,IAAVC,MAAM,GAAAD,IAAA,CAANC,MAAM;IACrB,OAAO,IAAIC,OAAO,CAAC,UAAAC,OAAO,EAAI;MAC5B1B,KAAK,CAAC2B,QAAQ,CAAC,cAAc,CAAC,CAACC,IAAI,CAAC,UAAAlB,GAAG,EAAI;QACzC,IAAMmB,cAAc,GAAGrB,iBAAiB,CAACV,WAAW,EAAEY,GAAG,CAACR,WAAW,CAAC;QACtEsB,MAAM,CAAC,YAAY,EAAEK,cAAc,CAAC;QACpCH,OAAO,CAACG,cAAc,CAAC;MACzB,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ;AACF,CAAC;AAED,eAAe;EACbC,UAAU,EAAE,IAAI;EAChBd,KAAK,EAALA,KAAK;EACLE,SAAS,EAATA,SAAS;EACTG,OAAO,EAAPA;AACF,CAAC"}]}