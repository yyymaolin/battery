{"remainingRequest":"D:\\Desktop\\Django\\fe_admin\\node_modules\\babel-loader\\lib\\index.js!D:\\Desktop\\Django\\fe_admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\Desktop\\Django\\fe_admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Desktop\\Django\\fe_admin\\src\\views\\cmdb\\servers\\components\\cuForm.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\Desktop\\Django\\fe_admin\\src\\views\\cmdb\\servers\\components\\cuForm.vue","mtime":1695288475452},{"path":"D:\\Desktop\\Django\\fe_admin\\babel.config.js","mtime":1695288475407},{"path":"D:\\Desktop\\Django\\fe_admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1698226179476},{"path":"D:\\Desktop\\Django\\fe_admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1698226183223},{"path":"D:\\Desktop\\Django\\fe_admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1698226179476},{"path":"D:\\Desktop\\Django\\fe_admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1698226183228}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLmNvbnN0cnVjdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc3BsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc2VhcmNoLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGNyZWF0ZVNlcnZlciwgdXBkYXRlU2VydmVyLCBnZXRTZXJ2ZXIsIGdldFNlcnZlclR5cGUgYXMgX2dldFNlcnZlclR5cGUsIGdldFNlcnZlclN5c3RlbVR5cGUgYXMgX2dldFNlcnZlclN5c3RlbVR5cGUgfSBmcm9tICdAL2FwaS9jbWRiL3NlcnZlcnMnOwppbXBvcnQgeyBnZXRBc3NldHNBZG1pbiBhcyBfZ2V0QXNzZXRzQWRtaW4sIGdldElEQ0NhYmluZXRzVHJlZSBhcyBfZ2V0SURDQ2FiaW5ldHNUcmVlIH0gZnJvbSAnQC9hcGkvY21kYi9hc3NldHMnOwppbXBvcnQgeyB2YWxpZGF0ZUlQIH0gZnJvbSAnQC91dGlscy9ydWxlc1ZhbGlkYXRlJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdDdUZvcm0nLAogIHByb3BzOiB7CiAgICBkaWFsb2dWaXNpYmxlOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAogICAgY3VySWQ6IHsKICAgICAgdHlwZTogTnVtYmVyLAogICAgICBkZWZhdWx0OiBudWxsCiAgICB9LAogICAgc3RhdHVzT3B0aW9uczogewogICAgICB0eXBlOiBBcnJheSwKICAgICAgZGVmYXVsdDogZnVuY3Rpb24gX2RlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcnVsZUZvcm06IHsKICAgICAgICBuYW1lOiAnJywKICAgICAgICBzbjogJycsCiAgICAgICAgYXNzZXRfc3RhdHVzOiBudWxsLAogICAgICAgIG1hbmFnZV9pcDogJycsCiAgICAgICAgYWRtaW46IG51bGwsCiAgICAgICAgY2FiaW5ldDogbnVsbCwKICAgICAgICBleHBpcmVfZGF5OiBudWxsLAogICAgICAgIG1lbW86ICcnLAogICAgICAgIHNlcnZlcjogewogICAgICAgICAgc2VydmVyX3R5cGU6ICcnLAogICAgICAgICAgc2VydmVyX3N5c3RlbV90eXBlOiAnJywKICAgICAgICAgIG1vZGVsOiAnJywKICAgICAgICAgIHVzZTogJycsCiAgICAgICAgICBhY2NvdW50czogW10KICAgICAgICB9CiAgICAgIH0sCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBhZG1pbk9wdGlvbnM6IFtdLAogICAgICBzZXJ2ZXJUeXBlT3B0aW9uczogW10sCiAgICAgIHNlcnZlclN5c3RlbU9wdGlvbnM6IFtdLAogICAgICBwaWNrZXJPcHRpb25zOiB7CiAgICAgICAgZGlzYWJsZWREYXRlOiBmdW5jdGlvbiBkaXNhYmxlZERhdGUodGltZSkgewogICAgICAgICAgcmV0dXJuIHRpbWUuZ2V0VGltZSgpIDwgRGF0ZS5ub3coKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGNhYmluZXRPcHRpb25zOiBbXSwKICAgICAgcnVsZXM6IHsKICAgICAgICBuYW1lOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicsCiAgICAgICAgICBtZXNzYWdlOiAn5pyN5Yqh5Zmo5ZCN5LiN6IO95Li656m6JwogICAgICAgIH1dLAogICAgICAgIHNuOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicsCiAgICAgICAgICBtZXNzYWdlOiAn6K6+5aSH5qCH5Y+35LiN6IO95Li656m6JwogICAgICAgIH1dLAogICAgICAgIG1hbmFnZV9pcDogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgdHJpZ2dlcjogJ2JsdXInLAogICAgICAgICAgbWVzc2FnZTogJ0lw5LiN6IO95Li656m6JwogICAgICAgIH0sIHsKICAgICAgICAgIHZhbGlkYXRvcjogdmFsaWRhdGVJUCwKICAgICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICAgIH1dLAogICAgICAgIGFzc2V0X3N0YXR1czogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgdHJpZ2dlcjogJ2JsdXInLAogICAgICAgICAgbWVzc2FnZTogJ+acjeWKoeWZqOeKtuaAgeS4jeiDveS4uuepuicKICAgICAgICB9XSwKICAgICAgICAnc2VydmVyLnNlcnZlcl90eXBlJzogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgdHJpZ2dlcjogJ2JsdXInLAogICAgICAgICAgbWVzc2FnZTogJ+exu+Wei+S4jeiDveS4uuepuicKICAgICAgICB9XSwKICAgICAgICAnc2VydmVyLnNlcnZlcl9zeXN0ZW1fdHlwZSc6IFt7CiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgIHRyaWdnZXI6ICdibHVyJywKICAgICAgICAgIG1lc3NhZ2U6ICfns7vnu5/nsbvlnovkuI3og73kuLrnqbonCiAgICAgICAgfV0KICAgICAgfQogICAgfTsKICB9LAogIHdhdGNoOiB7CiAgICBkaWFsb2dWaXNpYmxlOiBmdW5jdGlvbiBkaWFsb2dWaXNpYmxlKHYpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgaWYgKHYpIHsKICAgICAgICBpZiAodGhpcy5jdXJJZCkgewogICAgICAgICAgZ2V0U2VydmVyKHRoaXMuY3VySWQpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICBfdGhpcy5ydWxlRm9ybSA9IHJlcy5kYXRhOwogICAgICAgICAgICBpZiAocmVzLmRhdGEuYWRtaW4pIHsKICAgICAgICAgICAgICBfdGhpcy5hZG1pbk9wdGlvbnMgPSBbewogICAgICAgICAgICAgICAgaWQ6IHJlcy5kYXRhLmFkbWluLAogICAgICAgICAgICAgICAgdXNlcm5hbWU6IHJlcy5kYXRhLmFkbWluX2Rpc3BsYXkKICAgICAgICAgICAgICB9XTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHRoaXMuZ2V0U2VydmVyVHlwZSgpOwogICAgICAgIHRoaXMuZ2V0U2VydmVyU3lzdGVtVHlwZSgpOwogICAgICAgIHRoaXMuZ2V0SURDQ2FiaW5ldHNUcmVlKCk7CiAgICAgIH0KICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGNsb3NlOiBmdW5jdGlvbiBjbG9zZSgpIHsKICAgICAgdGhpcy4kcmVmcy5ydWxlRm9ybS5yZXNldEZpZWxkcygpOwogICAgICB0aGlzLnJ1bGVGb3JtLnNlcnZlci5hY2NvdW50cyA9IFtdOwogICAgICB0aGlzLiRlbWl0KCdjbG9zZScpOwogICAgfSwKICAgIHNlYXJjaDogZnVuY3Rpb24gc2VhcmNoKCkgewogICAgICB0aGlzLmNsb3NlKCk7CiAgICAgIHRoaXMuJGVtaXQoJ3NlYXJjaCcpOwogICAgfSwKICAgIC8vIOiOt+WPluacjeWKoeWZqOezu+e7n+exu+Wei+WIl+ihqAogICAgZ2V0U2VydmVyU3lzdGVtVHlwZTogZnVuY3Rpb24gZ2V0U2VydmVyU3lzdGVtVHlwZSgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgIF9nZXRTZXJ2ZXJTeXN0ZW1UeXBlKCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgX3RoaXMyLnNlcnZlclN5c3RlbU9wdGlvbnMgPSByZXMuZGF0YS5yZXN1bHRzOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDojrflj5bmnI3liqHlmajnsbvlnovliJfooagKICAgIGdldFNlcnZlclR5cGU6IGZ1bmN0aW9uIGdldFNlcnZlclR5cGUoKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwogICAgICBfZ2V0U2VydmVyVHlwZSgpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIF90aGlzMy5zZXJ2ZXJUeXBlT3B0aW9ucyA9IHJlcy5kYXRhLnJlc3VsdHM7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOiOt+WPluacuuaIv+acuuafnFRyZWXnu5PmnoTmlbDmja4KICAgIGdldElEQ0NhYmluZXRzVHJlZTogZnVuY3Rpb24gZ2V0SURDQ2FiaW5ldHNUcmVlKCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKICAgICAgX2dldElEQ0NhYmluZXRzVHJlZSgpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIF90aGlzNC5jYWJpbmV0T3B0aW9ucyA9IHJlcy5kYXRhLnJlc3VsdHM7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOacuuaIv+acuuafnOe6p+iBlOmAieaLqeWZqOeahGNoYW5nZQogICAgY2FiaW5ldEhhbmRsZUNoYW5nZTogZnVuY3Rpb24gY2FiaW5ldEhhbmRsZUNoYW5nZSh2YWx1ZSkgewogICAgICBpZiAodmFsdWUubGVuZ3RoID4gMCkgewogICAgICAgIHRoaXMucnVsZUZvcm0uY2FiaW5ldCA9IHZhbHVlW3ZhbHVlLmxlbmd0aCAtIDFdOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMucnVsZUZvcm0uY2FiaW5ldCA9IG51bGw7CiAgICAgIH0KICAgIH0sCiAgICAvLyDmn6Xmib7mnI3liqHlmajnrqHnkIblkZgKICAgIGdldEFzc2V0c0FkbWluOiBmdW5jdGlvbiBnZXRBc3NldHNBZG1pbihxdWVyeSkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKICAgICAgaWYgKHF1ZXJ5ICE9PSAnJykgewogICAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgICAgX2dldEFzc2V0c0FkbWluKHF1ZXJ5KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgIF90aGlzNS5hZG1pbk9wdGlvbnMgPSByZXMuZGF0YS5yZXN1bHRzOwogICAgICAgICAgX3RoaXM1LmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmFkbWluT3B0aW9ucyA9IFtdOwogICAgICB9CiAgICB9LAogICAgcmVtb3ZlQWNjb3VudDogZnVuY3Rpb24gcmVtb3ZlQWNjb3VudChpdGVtKSB7CiAgICAgIHZhciBpbmRleCA9IHRoaXMucnVsZUZvcm0uc2VydmVyLmFjY291bnRzLmluZGV4T2YoaXRlbSk7CiAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsKICAgICAgICB0aGlzLnJ1bGVGb3JtLnNlcnZlci5hY2NvdW50cy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB9CiAgICB9LAogICAgYWRkQWNjb3VudDogZnVuY3Rpb24gYWRkQWNjb3VudCgpIHsKICAgICAgdGhpcy5ydWxlRm9ybS5zZXJ2ZXIuYWNjb3VudHMucHVzaCh7CiAgICAgICAgdXNlcm5hbWU6ICcnLAogICAgICAgIHBhc3N3b3JkOiAnJywKICAgICAgICBwb3J0OiAnJwogICAgICB9KTsKICAgIH0sCiAgICAvLyDmj5DkuqTooajljZUKICAgIHN1Ym1pdEZvcm06IGZ1bmN0aW9uIHN1Ym1pdEZvcm0oZm9ybU5hbWUpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CiAgICAgIHRoaXMuJHJlZnNbZm9ybU5hbWVdLnZhbGlkYXRlKGZ1bmN0aW9uICh2YWxpZCkgewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgaWYgKF90aGlzNi5jdXJJZCkgewogICAgICAgICAgICBpZiAoIV90aGlzNi5ydWxlRm9ybS5waWQpIHsKICAgICAgICAgICAgICBfdGhpczYucnVsZUZvcm0ucGlkID0gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgICAgICB1cGRhdGVTZXJ2ZXIoX3RoaXM2LmN1cklkLCBfdGhpczYucnVsZUZvcm0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgIF90aGlzNi4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgICBtZXNzYWdlOiAn5L+u5pS55oiQ5YqfJywKICAgICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIF90aGlzNi5zZWFyY2goKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjcmVhdGVTZXJ2ZXIoX3RoaXM2LnJ1bGVGb3JtKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICBfdGhpczYuJG1lc3NhZ2UoewogICAgICAgICAgICAgICAgbWVzc2FnZTogJ+aWsOWinuaIkOWKnycsCiAgICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBfdGhpczYuc2VhcmNoKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnZXJyb3Igc3VibWl0ISEnKTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHJlc2V0Rm9ybTogZnVuY3Rpb24gcmVzZXRGb3JtKGZvcm1OYW1lKSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzOwogICAgICBpZiAodGhpcy5jdXJJZCkgewogICAgICAgIGdldFNlcnZlcih0aGlzLmN1cklkKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgIF90aGlzNy5ydWxlRm9ybSA9IHJlcy5kYXRhOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJHJlZnNbZm9ybU5hbWVdLnJlc2V0RmllbGRzKCk7CiAgICAgIH0KICAgIH0KICB9Cn07"},{"version":3,"names":["createServer","updateServer","getServer","getServerType","getServerSystemType","getAssetsAdmin","getIDCCabinetsTree","validateIP","name","props","dialogVisible","type","Boolean","default","curId","Number","statusOptions","Array","_default","data","ruleForm","sn","asset_status","manage_ip","admin","cabinet","expire_day","memo","server","server_type","server_system_type","model","use","accounts","loading","adminOptions","serverTypeOptions","serverSystemOptions","pickerOptions","disabledDate","time","getTime","Date","now","cabinetOptions","rules","required","trigger","message","validator","watch","v","_this","then","res","id","username","admin_display","methods","close","$refs","resetFields","$emit","search","_this2","results","_this3","_this4","cabinetHandleChange","value","length","query","_this5","removeAccount","item","index","indexOf","splice","addAccount","push","password","port","submitForm","formName","_this6","validate","valid","pid","$message","console","log","resetForm","_this7"],"sources":["src/views/cmdb/servers/components/cuForm.vue"],"sourcesContent":["<template>\r\n  <el-dialog :visible.sync=\"dialogVisible\" :title=\"curId ? '编辑服务器' : '新增服务器'\" width=\"720px\" :before-close=\"close\">\r\n    <el-form ref=\"ruleForm\" inline label-position=\"left\" :model=\"ruleForm\" status-icon :rules=\"rules\" label-width=\"100px\" class=\"demo-ruleForm\">\r\n      <el-card shadow=\"never\">\r\n        <el-form-item label=\"服务器名称\" prop=\"name\">\r\n          <el-input v-model=\"ruleForm.name\" clearable />\r\n        </el-form-item>\r\n        <el-form-item label=\"设备编号\" prop=\"sn\">\r\n          <el-input v-model=\"ruleForm.sn\" clearable />\r\n        </el-form-item>\r\n        <el-form-item label=\"IP\" prop=\"manage_ip\">\r\n          <el-input v-model=\"ruleForm.manage_ip\" clearable />\r\n        </el-form-item>\r\n        <el-form-item label=\"服务器状态\" prop=\"asset_status\">\r\n          <el-select v-model=\"ruleForm.asset_status\" clearable placeholder=\"选择服务器状态\">\r\n            <el-option\r\n              v-for=\"item in statusOptions\"\r\n              :key=\"item.value\"\r\n              :label=\"item.label\"\r\n              :value=\"item.value\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"管理员\" prop=\"admin\">\r\n          <el-select\r\n            v-model=\"ruleForm.admin\"\r\n            clearable\r\n            filterable\r\n            remote\r\n            placeholder=\"请输入用户名\"\r\n            :remote-method=\"getAssetsAdmin\"\r\n            :loading=\"loading\"\r\n          >\r\n            <el-option\r\n              v-for=\"item in adminOptions\"\r\n              :key=\"item.id\"\r\n              :label=\"item.username\"\r\n              :value=\"item.id\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"到期时间\" prop=\"expire_day\">\r\n          <el-date-picker\r\n            v-model=\"ruleForm.expire_day\"\r\n            type=\"date\"\r\n            placeholder=\"选择日期\"\r\n            :picker-options=\"pickerOptions\"\r\n            format=\"yyyy-MM-dd\"\r\n            value-format=\"yyyy-MM-dd\"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"所在机柜\" prop=\"cabinet\">\r\n          <el-cascader\r\n            v-model=\"ruleForm.cabinet\"\r\n            :options=\"cabinetOptions\"\r\n            :props=\"{ expandTrigger: 'hover' }\"\r\n            clearable\r\n            @change=\"cabinetHandleChange\"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"备注\" prop=\"memo\">\r\n          <el-input v-model=\"ruleForm.memo\" clearable />\r\n        </el-form-item>\r\n      </el-card>\r\n      <el-card shadow=\"never\">\r\n        <el-form-item label=\"类型\" prop=\"server.server_type\">\r\n          <el-select v-model=\"ruleForm.server.server_type\" clearable placeholder=\"选择服务器类型\">\r\n            <el-option\r\n              v-for=\"item in serverTypeOptions\"\r\n              :key=\"item.value\"\r\n              :label=\"item.label\"\r\n              :value=\"item.value\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"系统类型\" prop=\"server.server_system_type\">\r\n          <el-select v-model=\"ruleForm.server.server_system_type\" clearable placeholder=\"选择服务器系统类型\">\r\n            <el-option\r\n              v-for=\"item in serverSystemOptions\"\r\n              :key=\"item.value\"\r\n              :label=\"item.label\"\r\n              :value=\"item.value\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"系统版本\" prop=\"server.model\">\r\n          <el-input v-model=\"ruleForm.server.model\" clearable />\r\n        </el-form-item>\r\n        <el-form-item label=\"用途\" prop=\"server.use\">\r\n          <el-input v-model=\"ruleForm.server.use\" clearable />\r\n        </el-form-item>\r\n      </el-card>\r\n      <el-card shadow=\"never\">\r\n        <div v-for=\"(account, index) in ruleForm.server.accounts\" :key=\"index\">\r\n          <el-form-item\r\n            label=\"用户名\"\r\n            :prop=\"'server.' + 'accounts.' + index + '.username'\"\r\n            :rules=\"{\r\n              required: true, message: '用户名不能为空', trigger: 'blur'\r\n            }\"\r\n          >\r\n            <el-input v-model=\"account.username\" clearable />\r\n          </el-form-item>\r\n          <el-form-item\r\n            label=\"密码\"\r\n            :prop=\"'server.' + 'accounts.' + index + '.password'\"\r\n            :rules=\"{\r\n              required: true, message: '密码不能为空', trigger: 'blur'\r\n            }\"\r\n          >\r\n            <el-input v-model=\"account.password\" clearable />\r\n          </el-form-item>\r\n          <el-form-item\r\n            label=\"端口\"\r\n            :prop=\"'server.' + 'accounts.' + index + '.port'\"\r\n            :rules=\"{\r\n              required: true, message: '端口不能为空', trigger: 'blur'\r\n            }\"\r\n          >\r\n            <el-input v-model=\"account.port\" clearable />\r\n          </el-form-item>\r\n          <el-button @click.prevent=\"removeAccount(account)\">删除</el-button>\r\n        </div>\r\n        <el-button @click=\"addAccount\">新增账户</el-button>\r\n      </el-card>\r\n      <el-form-item class=\"el-sub-button\">\r\n        <el-button type=\"primary\" @click=\"submitForm('ruleForm')\">提交</el-button>\r\n        <el-button @click=\"resetForm('ruleForm')\">重置</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </el-dialog>\r\n</template>\r\n<script>\r\nimport { createServer, updateServer, getServer, getServerType, getServerSystemType } from '@/api/cmdb/servers'\r\nimport { getAssetsAdmin, getIDCCabinetsTree } from '@/api/cmdb/assets'\r\nimport { validateIP } from '@/utils/rulesValidate'\r\nexport default {\r\n  name: 'CuForm',\r\n  props: {\r\n    dialogVisible: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    curId: {\r\n      type: Number,\r\n      default: null\r\n    },\r\n    statusOptions: {\r\n      type: Array,\r\n      default: () => {\r\n        return\r\n      }\r\n    }\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      ruleForm: {\r\n        name: '',\r\n        sn: '',\r\n        asset_status: null,\r\n        manage_ip: '',\r\n        admin: null,\r\n        cabinet: null,\r\n        expire_day: null,\r\n        memo: '',\r\n        server: {\r\n          server_type: '',\r\n          server_system_type: '',\r\n          model: '',\r\n          use: '',\r\n          accounts: []\r\n        }\r\n      },\r\n      loading: false,\r\n      adminOptions: [],\r\n      serverTypeOptions: [],\r\n      serverSystemOptions: [],\r\n      pickerOptions: {\r\n        disabledDate(time) {\r\n          return time.getTime() < Date.now()\r\n        }\r\n      },\r\n      cabinetOptions: [],\r\n      rules: {\r\n        name: [{ required: true, trigger: 'blur', message: '服务器名不能为空' }],\r\n        sn: [{ required: true, trigger: 'blur', message: '设备标号不能为空' }],\r\n        manage_ip: [\r\n          { required: true, trigger: 'blur', message: 'Ip不能为空' },\r\n          { validator: validateIP, trigger: 'blur' }\r\n        ],\r\n        asset_status: [{ required: true, trigger: 'blur', message: '服务器状态不能为空' }],\r\n        'server.server_type': [{ required: true, trigger: 'blur', message: '类型不能为空' }],\r\n        'server.server_system_type': [{ required: true, trigger: 'blur', message: '系统类型不能为空' }]\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    dialogVisible(v) {\r\n      if (v) {\r\n        if (this.curId) {\r\n          getServer(this.curId).then(res => {\r\n            this.ruleForm = res.data\r\n            if (res.data.admin) {\r\n              this.adminOptions = [{ id: res.data.admin, username: res.data.admin_display }]\r\n            }\r\n          })\r\n        }\r\n        this.getServerType()\r\n        this.getServerSystemType()\r\n        this.getIDCCabinetsTree()\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    close() {\r\n      this.$refs.ruleForm.resetFields()\r\n      this.ruleForm.server.accounts = []\r\n      this.$emit('close')\r\n    },\r\n    search() {\r\n      this.close()\r\n      this.$emit('search')\r\n    },\r\n    // 获取服务器系统类型列表\r\n    getServerSystemType() {\r\n      getServerSystemType().then(res => {\r\n        this.serverSystemOptions = res.data.results\r\n      })\r\n    },\r\n    // 获取服务器类型列表\r\n    getServerType() {\r\n      getServerType().then(res => {\r\n        this.serverTypeOptions = res.data.results\r\n      })\r\n    },\r\n    // 获取机房机柜Tree结构数据\r\n    getIDCCabinetsTree() {\r\n      getIDCCabinetsTree().then(res => {\r\n        this.cabinetOptions = res.data.results\r\n      })\r\n    },\r\n    // 机房机柜级联选择器的change\r\n    cabinetHandleChange(value) {\r\n      if (value.length > 0) {\r\n        this.ruleForm.cabinet = value[value.length - 1]\r\n      } else {\r\n        this.ruleForm.cabinet = null\r\n      }\r\n    },\r\n    // 查找服务器管理员\r\n    getAssetsAdmin(query) {\r\n      if (query !== '') {\r\n        this.loading = true\r\n        getAssetsAdmin(query).then(res => {\r\n          this.adminOptions = res.data.results\r\n          this.loading = false\r\n        })\r\n      } else {\r\n        this.adminOptions = []\r\n      }\r\n    },\r\n    removeAccount(item) {\r\n      var index = this.ruleForm.server.accounts.indexOf(item)\r\n      if (index !== -1) {\r\n        this.ruleForm.server.accounts.splice(index, 1)\r\n      }\r\n    },\r\n    addAccount() {\r\n      this.ruleForm.server.accounts.push({\r\n        username: '',\r\n        password: '',\r\n        port: ''\r\n      })\r\n    },\r\n    // 提交表单\r\n    submitForm(formName) {\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          if (this.curId) {\r\n            if (!this.ruleForm.pid) {\r\n              this.ruleForm.pid = null\r\n            }\r\n            updateServer(this.curId, this.ruleForm).then(res => {\r\n              this.$message({\r\n                message: '修改成功',\r\n                type: 'success'\r\n              })\r\n              this.search()\r\n            })\r\n          } else {\r\n            createServer(this.ruleForm).then(res => {\r\n              this.$message({\r\n                message: '新增成功',\r\n                type: 'success'\r\n              })\r\n              this.search()\r\n            })\r\n          }\r\n        } else {\r\n          console.log('error submit!!')\r\n          return false\r\n        }\r\n      })\r\n    },\r\n    resetForm(formName) {\r\n      if (this.curId) {\r\n        getServer(this.curId).then(res => {\r\n          this.ruleForm = res.data\r\n        })\r\n      } else {\r\n        this.$refs[formName].resetFields()\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.demo-ruleForm ::v-deep .el-card__body {\r\n    padding: 10px 10px 0 10px;\r\n  }\r\n.demo-ruleForm ::v-deep .el-card {\r\n    margin-bottom: 10px;\r\n  }\r\n.el-sub-button{\r\n margin-left: 112px;\r\n}\r\n</style>\r\n"],"mappings":"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"}]}